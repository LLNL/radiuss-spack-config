#!/bin/bash

SCRIPT_DIR="$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"
REPO_DIR=$SCRIPT_DIR/..
BASE_PATH=test_dir

# get-spack variables
export SPACK_REPO=https://github.com/spack/spack.git
export SPACK_PATH=spack
export SPACK_REF="${SPACK_REF:-develop}"
export CI_PIPELINE_ID="${CI_PIPELINE_ID:-default-value}"

echo "~~~~~~~~~~~~~ test-blt variables ~~~~~~~~~~~~~~"
  echo SCRIPT_DIR=$SCRIPT_DIR
  echo REPO_DIR=$REPO_DIR
  echo BASE_PATH=$BASE_PATH
  echo SPACK_REPO=$SPACK_REPO
  echo SPACK_PATH=$SPACK_PATH
  echo SPACK_REF=$SPACK_REF
  echo CI_PIPELINE_ID=$CI_PIPELINE_ID
echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"

rm -rf $BASE_PATH
mkdir $BASE_PATH

cd $BASE_PATH
  # Setup spack
  $SCRIPT_DIR/get-spack
  cp -R $REPO_DIR/packages/* $SPACK_PATH/var/spack/repos/builtin/packages

  # clone BLT
  git clone https://github.com/LLNL/blt.git blt

cd ..
